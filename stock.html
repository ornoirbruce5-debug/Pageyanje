<!DOCTYPE html>
<html lang="rw">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Stock yose — Jeune Boutique</title>

  <!-- Styles -->
  <link rel="stylesheet" href="css/stock.css" />

  <!-- Dark mode persistence -->
  <script>
    function toggleDark() {
      document.body.classList.toggle('dark');
      localStorage.setItem('jb_dark', document.body.classList.contains('dark'));
    }
    window.addEventListener('load', () => {
      if (localStorage.getItem('jb_dark') === 'true') {
        document.body.classList.add('dark');
      }
    });
  </script>
</head>
<body class="stock-page">
  <!-- Fullscreen background -->
  <div class="video-bg" aria-hidden="true"></div>

  <!-- Overlay content -->
  <div class="page-overlay">
    <!-- Topbar -->
    <header class="topbar">
      <div class="logo">Jeune Boutique ✨</div>
      <nav>
        <a href="index.html">🏠 Home</a>
        <a href="cart.html">🛒 Gare</a>
        <a href="admin.html">⚙️ Admin</a>
      </nav>
    </header>

    <!-- Hero -->
    <section class="hero-intro">
      <h1>🛍️ Stock yose</h1>
      <p>
        Shakisha, filteringa, ugure vuba—byose birateguwe. Turakwakira vuba na WhatsApp autoresponder ✨
      </p>
    </section>

    <!-- Catalogue -->
    <main class="section">
      <div class="stock-controls">
        <input id="searchBar" type="text" placeholder="🔍 Shakisha ibicuruzwa…" class="search-input" />
        <div class="filters">
          <button data-cat="all" class="filter-btn active">Byose</button>
          <button data-cat="amata" class="filter-btn">Amata</button>
          <button data-cat="ibinyobwa" class="filter-btn">Ibinyobwa</button>
          <button data-cat="ibirato vyabahungu" class="filter-btn">Ibirato Boys</button>
          <button data-cat="ibirato vy'abakobwa" class="filter-btn">Ibirato Girls</button>
          <button data-cat="impuzu" class="filter-btn">Impuzu</button>
        </div>
      </div>

      <div id="productsGrid" class="products-grid"></div>
      <div id="pagination" class="pagination"></div>

      <!-- WhatsApp -->
      <section class="whatsapp-section">
        <h2>📞 Twandikire kuri WhatsApp</h2>
        <img src="images/whatsapp-qr.jpg" alt="Scan WhatsApp QR" class="qr-code" />
        <p>
          Cyangwa
          <a href="https://wa.me/25771633859?text=Mwaramutse%20Jeune%20Boutique%2C%20ndifuza%20ibicuruzwa%20mufise%20uyu%20munsi%20😊" target="_blank">
            kanda hano kugira ngo utangire ikiganiro
          </a>
          💬
        </p>
      </section>
    </main>

    <!-- Chatbot -->
    <section id="chatbot" class="chatbot">
      <h2>Chatbot 🤖</h2>
      <div id="chatWindow" class="chat-window"></div>
      <div class="chat-controls">
        <input id="chatInput" class="chat-input" placeholder="Andika hano..." />
        <button id="sendBtn" class="btn-primary">Send</button>
      </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
      <p>&copy; 2025 Jeune Boutique — Made with 💖 in Gihosha</p>
    </footer>
  </div>

  <!-- Floating controls -->
  <button onclick="toggleDark()" class="dark-toggle" aria-label="Hindura mode">🌙</button>
  <a href="cart.html" class="floating-cart" aria-label="Gare">🛒</a>

  <!-- Scripts -->
  <script src="js/products.js"></script>
  <script>
    const grid = document.getElementById('productsGrid');
    const searchBar = document.getElementById('searchBar');
    const filterBtns = document.querySelectorAll('.filter-btn');
    const pag = document.getElementById('pagination');

    let currentPage = 1;
    const perPage = 12;
    let currentList = (typeof JB_PRODUCTS !== 'undefined') ? JB_PRODUCTS : [];

    function addToCart(product) {
      const cart = JSON.parse(localStorage.getItem('jb_cart') || '[]');
      cart.push({ id: product.id, name: product.name, price: product.price, qty: 1 });
      localStorage.setItem('jb_cart', JSON.stringify(cart));
      alert(`${product.name} yongewe mu gare 🛒`);
    }

    function productCard(p) {
      return `
        <article class="card">
          <img src="${p.image}" alt="${p.name}" class="card-img" loading="lazy">
          <h3 class="card-title">${p.name}</h3>
          <p class="card-desc">${p.desc || ''}</p>
          <div class="card-meta">
            <span class="card-price">${p.price} Fbu</span>
            <small>Stock: ${p.stock}</small>
          </div>
          <button class="button">Fata 🛒</button>
        </article>
      `;
    }

    function renderProducts(list) {
      grid.innerHTML = '';
      if (list.length === 0) {
        grid.innerHTML = `
          <div class="empty-state">
            <p>😢 Ntacyo twabonye kijyanye n'ibyo ushakisha</p>
            <img src="images/empty.png" alt="No products">
          </div>
        `;
        pag.innerHTML = '';
        return;
      }
      const frag = document.createDocumentFragment();
      list.forEach(p => {
        const wrap = document.createElement('div');
        wrap.innerHTML = productCard(p);
        wrap.querySelector('button').addEventListener('click', () => addToCart(p));
        frag.appendChild(wrap);
      });
      grid.appendChild(frag);
    }

    function renderPage(list, page) {
      const start = (page - 1) * perPage;
      const end = start + perPage;
      renderProducts(list.slice(start, end));
      renderPagination(list.length, page);
    }

    function renderPagination(total, page) {
      const pages = Math.ceil(total / perPage) || 1;
      pag.innerHTML = '';
      for (let i = 1; i <= pages; i++) {
        const btn = document.createElement('button');
        btn.textContent = i;
        btn.className = i === page ? 'active' : '';
        btn.addEventListener('click', () => { currentPage = i; renderPage(currentList, i); });
        pag.appendChild(btn);
      }
    }

    // Search
    searchBar.addEventListener('input', e => {
      const q = e.target.value.toLowerCase();
      currentList = JB_PRODUCTS.filter(p =>
        (p.name || '').toLowerCase().includes(q) ||
        (p.desc || '').toLowerCase().includes(q)
      );
      currentPage = 1;
      renderPage(currentList, currentPage);
    });

    // Filters
    filterBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        filterBtns.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        const cat = btn.dataset.cat;
        currentList = cat === 'all' ? JB_PRODUCTS : JB_PRODUCTS.filter(p => p.category === cat);
        currentPage = 1;
        renderPage(currentList, currentPage);
      });
    });

    // Initial render
    renderPage(currentList, currentPage);
  </script>
<!-- Chatbot logic -->
  <script>
    const chatWindow = document.getElementById('chatWindow');
    const chatInput = document.getElementById('chatInput');
    const sendBtn = document.getElementById('sendBtn');

    function appendMessage(sender, text) {
      const msg = document.createElement('div');
      msg.className = sender;
      msg.textContent = text;
      chatWindow.appendChild(msg);
      chatWindow.scrollTop = chatWindow.scrollHeight;
    }

    function botReply(userText) {
      let reply = "Ndakumva neza 🌸. Turafise ibicuruzwa bitandukanye, ushobora kubishakisha hejuru.";

      const txt = userText.toLowerCase();
      if (txt.includes("amata")) {
        reply = "Amata dufise: Yaourt Nature na Milk Fresh 🥛.";
      } else if (txt.includes("ibirato")) {
        reply = "Dufise ibirato vy’abahungu na vy’abakobwa: Sneakers Trendy, Ibirato Boys, Ibirato Girls 👟.";
      } else if (txt.includes("ibinyobwa")) {
        reply = "Ibinyobwa: Fanta Orange na Juice Cocktail 🍹.";
      } else if (txt.includes("impuzu")) {
        reply = "Impuzu zacu zirimo T-shirt Jeune na Cap Youth 👕🧢.";
      } else if (txt.includes("amahereni")) {
        reply = "Amahereni Gold arashoboye cyane ✨.";
      }

      appendMessage("bot", reply);
    }

    sendBtn.addEventListener('click', () => {
      const text = chatInput.value.trim();
      if (!text) return;
      appendMessage("user", text);
      chatInput.value = "";
      setTimeout(() => botReply(text), 500);
    });

    chatInput.addEventListener('keypress', e => {
      if (e.key === "Enter") {
        sendBtn.click();
      }
    });
  </script>
</body>
</html>
